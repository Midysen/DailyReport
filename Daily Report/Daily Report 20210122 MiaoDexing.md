# 欧拉角和姿态角
欧拉角是描述旋转的一种方式，那姿态角呢？姿态角属于欧拉角的一种特殊形式，我们一般定义姿态角为偏航（Yaw），俯仰（Pitch），横滚（Roll）。在不同的载体坐标系里，姿态角对应也不一样。
- ENU-右前上
右前上坐标系下，Z对应偏航，Y对应横滚，X对应俯仰。所以在常用的姿态旋转顺序（Yaw-Pitch-Roll）中，对应的旋转方式为（Z-X-Y）。
- NED-前右下
前右下坐标系下，Z对应偏航，Y对应俯仰，X对应横滚。所以在常用的姿态旋转顺序（Yaw-Pitch-Roll）中，对应的旋转方式为（Z-Y-X）

# 旋转规则
旋转规则分两种：
- Proper Euler angles (z-x-z, x-y-x, y-z-y, z-y-z, x-z-x, y-x-y) 经典欧拉角
- Tait–Bryan angles (x-y-z, y-z-x, z-x-y, x-z-y, z-y-x, y-x-z) 卡尔丹角
每种规则都使用了3个变量描述三次旋转过程中的旋转角度, 差别在于Proper Euler angles只涉及两个转轴.而Tait–Bryan angles涉及三个转轴。
一般我们习惯使用卡尔丹角来旋转，在姿态的旋转中，一般使用（Yaw-Pitch-Roll）的旋转顺序。

# 姿态解算的基本概念
说是概念，其实确切来讲是应该弄清楚的事情：
- 1、姿态解算中的传感器的特性。对于加速度，其大小使用三角公式得到一个角度（笔者这么干过，确实行之有效），但是这个角度在旋转瞬间是十分不稳定的，例如在水平面转到10度左右的时候，这个角度很可能超过20度，之后会慢慢回到10度，即所谓的“短期不稳定，长期稳定”；对于角速度，可以通过“角度=∫角速度dt”这样的公式得到角度，但是这样做的时候会发现当在瞬间旋转的时候，得到的角度差是准确的，但是一旦长期不矫正这个角度，这个角度就会远远的偏离实际的角度，即所谓的“短期稳定，长期不稳定”；而磁力计的特性就偏好，短期和长期都可以很稳定，但是在飞机倾斜的时候，原本的磁场数据就会变得不准确，需要校准。
- 2、姿态解算中谁是主角。在接触飞控之初，我觉得加速度应该是主力（当时还不知道yaw轴长期的漂移现象），毕竟他的数据是长期稳定的，但是很遗憾，在当下接触到的姿态解算算法，大多数是以角速度作为姿态解算的主角，这点希望初学者要谨记在心。
- 3、DCM矩阵（方向余弦矩阵），这个名词对于飞控的“高阶玩家”确实不应该感到陌生，但是对于初学者，可能知道更多的是四元数，但是笔者在这里还是要说一下，在姿态解算中，甚至到后面的定高、定点算法中，DCM矩阵都会起到很大的作用，而不是四元数。简单的来讲，DCM矩阵的作用就是把A坐标系的数据旋转到B坐标，举个简单的例子，你可以通过DCM矩阵把机体上的三轴加速度计数据旋转到世界坐标系下。


# 姿态角与欧拉角的定义
对于导航和控制问题，似乎都是把姿态角和欧拉角混为一谈，但实际上它们并不是同一个概念。最开始思考这个问题是因为旋转矩阵中涉及到的三个角度是欧拉角，为何可以通过把求解旋转矩阵获得的欧拉角当作姿态角？

对于旋转问题，欧拉角指的是绕某个轴旋转的角度，而姿态角指的是载体系与导航系之间的关系。滚转角是z轴与通过x轴的铅锤面的夹角，x轴投影到水平面与导航系的夹角即为航向角，俯仰角则是x轴与水平面的夹角。

很显然姿态角与欧拉角并不是同一个概念，那为何可以把姿态角和欧拉角画上等号？这就是涉及到下一个问题。

# 导航系到载体系旋转矩阵的旋转顺序为何只能是ZYX（NED坐标系）？
思考这个问题在于，旋转矩阵跟旋转顺序有关，如果旋转顺序不同那么其旋转矩阵就不同，那为何旋转矩阵都是确定的？这就在于旋转顺序只能是ZYX。

由于滚转角是z轴与通过x轴的铅锤面的夹角，即绕x轴旋转的角度，在n系和b系的转换的任何时候，滚转角可以等价于欧拉角。航向角需要先将x轴投影到水平面，再与导航系的x轴作夹角，所以需要最先旋转z轴，此时航向角等于欧拉角。旋转之后，绕y轴旋转，此时俯仰角和欧拉角相等。这就解释了为何只能是ZYX的旋转顺序，否则，欧拉角和姿态角之间就不相等，同时也解释了第一个问题。
